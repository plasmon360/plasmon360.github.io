
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="HandheldFriendly" content="True" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="robots" content="" />

  <link href="https://fonts.googleapis.com/css?family=Source+Code+Pro|Source+Sans+Pro:300,400,400i,700" rel="stylesheet">

    <link rel="stylesheet" type="text/css" href="/theme/stylesheet/style.min.css">

  <link rel="stylesheet" type="text/css" href="/theme/pygments/github.min.css">
  <link rel="stylesheet" type="text/css" href="/theme/font-awesome/css/fontawesome.css">
  <link rel="stylesheet" type="text/css" href="/theme/font-awesome/css/brands.css">
  <link rel="stylesheet" type="text/css" href="/theme/font-awesome/css/solid.css">







<meta name="author" content="juluribk" />
<meta name="description" content="Optical power meters in-conjunction with a detector are used to measure power from a laser source or monochromatic output. At work, we use Newport 1918 power meter. This power meter comes with its own software. However, I was interested in controlling this instrument with python. I made a class for …" />
<meta name="keywords" content="Instrumentation, python">


<meta property="og:site_name" content="Bala Juluri's Blog"/>
<meta property="og:title" content="Controlling Newport 1918 Power Meter with Python"/>
<meta property="og:description" content="Optical power meters in-conjunction with a detector are used to measure power from a laser source or monochromatic output. At work, we use Newport 1918 power meter. This power meter comes with its own software. However, I was interested in controlling this instrument with python. I made a class for …"/>
<meta property="og:locale" content="en_US"/>
<meta property="og:url" content="/newport-1918-power-meter-with-python.html"/>
<meta property="og:type" content="article"/>
<meta property="article:published_time" content="2015-04-04 12:23:00-07:00"/>
<meta property="article:modified_time" content=""/>
<meta property="article:author" content="/author/juluribk.html">
<meta property="article:section" content="Test Equipment"/>
<meta property="article:tag" content="Instrumentation"/>
<meta property="article:tag" content="python"/>
<meta property="og:image" content="">

  <title>Bala Juluri's Blog &ndash; Controlling Newport 1918 Power Meter with Python</title>

</head>
<body>
  <aside>
    <div>
      <a href="">
        <img src="/theme/img/profile.png" alt="" title="">
      </a>
      <h1><a href=""></a></h1>

<p>Ramblings</p>
      <nav>
        <ul class="list">


            <li><a target="_blank" href="http://getpelican.com/" >Pelican</a></li>
            <li><a target="_blank" href="http://python.org/" >Python.org</a></li>
            <li><a target="_blank" href="http://jinja.pocoo.org/" >Jinja2</a></li>
            <li><a target="_blank" href="#" >You can modify those links in your config file</a></li>
        </ul>
      </nav>

      <ul class="social">
          <li>
            <a  class="sc-You can add links in your config file" href="#" target="_blank">
            <i class="fab fa-You can add links in your config file">
            </i>
          </a></li>
          <li>
            <a  class="sc-Another social link" href="#" target="_blank">
            <i class="fab fa-Another social link">
            </i>
          </a></li>
      </ul>
    </div>


  </aside>
  <main>


<article class="single">
  <header>
      
    <h1 id="newport-1918-power-meter-with-python">Controlling Newport 1918 Power Meter with Python</h1>
    <p>
          Posted on Sat 04 April 2015 in <a href="/category/test-equipment.html">Test Equipment</a>


    </p>
  </header>


  <div>
    <p><a href="http://juluribk.com/wp-content/uploads/2015/04/23632.jpg"><img alt="Newport 1918 power meter" class="aligncenter size-medium wp-image-1456" height="225" src="http://juluribk.com/wp-content/uploads/2015/04/23632-300x225.jpg" width="300"></a></p>
<p>Optical power meters in-conjunction with a detector are used to measure power from a laser source or monochromatic output. At work, we use <a href="http://www.newport.com/Optical-Power-Meter-High-Performance-Hand-Held-19/509478/1033/info.aspx" title="Newport 1918">Newport 1918</a> power meter. This power meter comes with its own <a href="http://www.newport.com/Optical-Power-Meter-High-Performance-Hand-Held-19/509478/1033/info.aspx#tab_Literature" title="software">software</a>. However, I was interested in controlling this instrument with python. I made a class for this instrument . If you are interested you can download it at my <strong><a href="https://github.com/plasmon360/python_newport_1918_powermeter" title="Documentation and Github Repositry"> Github repostitory</a></strong>.</p>
<p>This python module contains higher level functions to communicate with <a href="http://www.newport.com/1918-R-HandHeld-Optical-Power-and-Energy-Meter/509478/1033/info.aspx#tab_Overview">Newport 1918 power meter</a> on a Windows computer. It uses python ctypes to access methods in the Newport's usbdll.dll driver.</p>
<p>For connecting the hardware to the computer, see the <a href="http://assets.newport.com/webDocuments-EN/images/RevA1918-RPowerMeterUsersManual.pdf">reference manual</a></p>
<h2><a class="anchor" href="https://github.com/plasmon360/python_newport_1918_powermeter#installing-the-powermeter-and-usbdriver" id="user-content-installing-the-powermeter-and-usbdriver"></a>Installing the powermeter and usbdriver</h2>
<p><a href="http://assets.newport.com/webDocuments-EN/images/Computer_Interface_Software_v3.0.2.zip">Click here to download the newport powermeter Application and driver</a></p>
<ul>
<li>On a 32 bit computer:<ol>
<li>Unzip the file</li>
<li>Install the drivers and the power application found PowerMeter 3.0.2\win32</li>
<li>run both PMSetup32.msi and USBDriverSetup32.msi (in sub folder). This should install drivers and the newport powermeter application at C:\Program Files\Newport</li>
<li>LIBNAME (argument that is needed to intialize the instrument) in the case will be r'C:\Program Files\Newport\Newport USB Driver\Bin\usbdll.dll'</li>
</ol>
</li>
<li>On a 64 bit computer:<ol>
<li>Unzip the file.</li>
<li>Install the drivers and the power application found PowerMeter 3.0.2\x86Onx64</li>
<li>run both PMSetup32on64.msi and USBDriverSetup32on64.msi (in sub folder). This should install drivers and the newport powermeter application at C:\Program Files (x86)\Newport</li>
<li>LIBNAME (argument that is needed to intialize the instrument) in the case will be r'C:\Program Files (x86)\Newport\Newport USB Driver\Bin\usbdll.dll'</li>
</ol>
</li>
</ul>
<p>Before you run the python module, make sure that you can run the newport powermeter application. This will ensure that the drivers are installed properly and there is no problem communicating with the instrument.</p>
<h2><a class="anchor" href="https://github.com/plasmon360/python_newport_1918_powermeter#getting-the-product-id" id="user-content-getting-the-product-id"></a>Getting the Product ID</h2>
<p>The variable "product_id" is needed to intialize the instrument. For my case, the product_id was 0xCEC7. I am not sure if this will change on another computer. To find the product_id or PID,</p>
<ol>
<li>Open the Windows Device Manager</li>
<li>Expand the Human Interface Devices node</li>
<li>Double-click the device of interest -- the USB Human Interface Device Properties window appears</li>
<li>Click the Details tab.</li>
<li>In the Property drop-down box, select Hardware Ids. The product id is some thinglike PID_ABC1, then use product_id = 0xABC1.</li>
</ol>
<p><a href="http://thecurlybrace.blogspot.com/2010/07/how-to-find-usb-device-vendor-and.html">See Here fore more detailed explaination !</a></p>
<h2><a class="anchor" href="https://github.com/plasmon360/python_newport_1918_powermeter#additional-notes" id="user-content-additional-notes"></a>Additional notes</h2>
<ul>
<li>
<p>There are many methods in the usbdll.dll, you can see all the methods in <a href="https://github.com/plasmon360/python_newport_1918_powermeter/blob/master/NewpDll.h">NewPDll.h</a>. The methods I use to connect/disconnection and read/write commands are:</p>
</li>
<li>
<p>newp_usb_init_system - this function opens all USB instruments.</p>
</li>
<li>newp_usb_get_device_info - this function retrieves the USB address of all open instruments.</li>
<li>newp_usb_get_ascii - this function reads the response data from an instrument.</li>
<li>newp_usb_send_ascii - this function sends the passed in command to an instrument.</li>
<li>newp_usb_send_binary - this function sends the passed in binary data to an instrument.</li>
<li>
<p>newp_usb_uninit_system - this function closes all USB instruments.</p>
</li>
<li>
<p>A full list of commands that can be sent to the instrument can be found in the <a href="http://assets.newport.com/webDocuments-EN/images/RevA1918-RPowerMeterUsersManual.pdf">reference manual</a></p>
</li>
</ul>
  </div>
  <div class="tag-cloud">
    <p>
      <a href="/tag/instrumentation.html">Instrumentation</a>
      <a href="/tag/python.html">python</a>
    </p>
  </div>





</article>

    <footer>
<p>&copy;  </p>
<p>    Built with <a href="http://getpelican.com" target="_blank">Pelican</a> using <a href="http://bit.ly/flex-pelican" target="_blank">Flex</a> theme
</p>    </footer>
  </main>




<script type="application/ld+json">
{
  "@context" : "http://schema.org",
  "@type" : "Blog",
  "name": " Bala Juluri's Blog ",
  "url" : "",
  "image": "",
  "description": ""
}
</script>

</body>
</html>